---
layout: post
title: "Ajax and javascript"
---

首先，ajax是一个柔和了多种手段的技术，其目的也是为了在不刷新页面的情况下，与服务器交互。

传统方式的js ajax执行方式代码如下：

先对DOM对象新增一个输入框（input）

    <input type="button" value="Ajax提交" onclick="Ajax();"/>

给这个输入框绑定点击事件，触发Ajax();

跟新代码，新增id为resText的元素，用来显示响应后的信息

    <input type="button" value="Ajax提交" onclick="Ajax();"/>
    <div id="resText"></div>

下面是js代码，首先声明一个Ajax(),然后将实例化一个XMLHttpRequest对象

    function Ajax() {
        .....
    }

以下是所有细节

    function Ajax() {

        var xmlHttpReq = null; //定义一个空对象
        //为xmlHttpReq变量赋值
        if(window.ActiveXObject) {
            xmlHttpReq = new Active Xobject("Microsoft.XMLHTTP");//实例化一个IE浏览器下的XMLHttpRequest对象
        } else if(window.XMLHttpRequest) {
            xmlHttpReq = new XMLHttpRequest(); //实例化非IE浏览下的XMLHttpRequest对象
        }
        //实例化XMLHttpRequest对象后，要对其初始化
        xmlHttpReq.open("GET","test.php",true);
        //初始化对象之后，要声明一个回调函数，用来当响应返回的时候执行
        xmlHttpReq.onreadystatechange = RequestCallBack;
        //初始化后，将请求发送,由于是GET请求，所以，参数为null
        xmlHttpReq.send(null);
        //声明RequestCallBack()函数体
        function RequestCallBack() {
            if(xmlHttpReq.readyState == 4) {
                if(xmlHttpReq.status == 200) {
                    document.getElementById("resText").innerHTML = xmlHttpReq.responseText;
                }
            }
        }

    }

总结：
由于各个浏览器的表现不同，在实例化XMLHttpRequest对象的时候，需要做一些判断，用以生成正确的XMLHttpRequest对象。实际上，当实例化一个XMLHttpRequest对象之后，首先要做的就是对其初始化。使用open()方法
初始化，类似于子弹上膛，等待send()方法将请求发送出去。至于res响应之后，XMLHttpRequest对象该做什么事情，默认的它有个onreadystatechange()回调函数，用来对响应的状态做出判断从而执行相应的代码。在这个
例子中，只有当状态码都显示最后的时候，也就是完全响应之后，再执行打印的方法。

